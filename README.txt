# anomaly_sniffer - руководство пользователя

1. Режим сбора данных (collect)
Этот режим предназначен для сбора сетевых метрик в течение определенного времени и сохранения их в файл. Собранные данные затем могут быть использованы для обучения модели в режиме train.

Синтаксис команды:
python main.py collect --interface <интерфейс> --network <сеть> --data-file <путь_к_файлу> [опции]

Обязательные аргументы:
--interface <интерфейс>: Указывает, какой сетевой интерфейс будет "прослушиваться". Например, eth0 для Ethernet или Wi-Fi для беспроводной сети. Модуль sniffer.py использует Scapy для захвата пакетов только с этого интерфейса.

--network <сеть>: Задаёт диапазон IP-адресов в формате CIDR (например, 192.168.1.0/24), трафик для которых будет анализироваться. Это позволяет фильтровать пакеты и обрабатывать только те, которые относятся к вашей локальной сети.

--data-file <путь_к_файлу>: Путь к файлу в формате CSV, куда будут записываться агрегированные метрики.

Опции:
--interval <секунды>: Интервал агрегации метрик. Программа будет собирать данные в течение этого времени, а затем записывать их в файл. По умолчанию: 10

---


## 2. Режим обучения (train)
Этот режим используется для обучения нейронной сети на данных, которые считаются "нормальным" трафиком. В результате обучения создаются файлы модели и объекта-масштабировщика, которые затем используются для обнаружения аномалий.

### Синтаксис команды:
`python main.py train --data-file <путь_к_файлу> [опции]`

### Обязательный аргумент:
* `--data-file <путь_к_файлу>`: Путь к файлу с данными в формате CSV, на которых будет производиться обучение.

### Опции:
* `--time-step <число>`: Размер временного шага для последовательностей, используемых в нейронной сети. По умолчанию: 10.
* `--epochs <число>`: Количество эпох обучения. По умолчанию: 50.
* `--batch-size <число>`: Размер пакета для обучения. По умолчанию: 16.
* `--model-dir <папка>`: Директория для сохранения обученных файлов модели и scaler. По умолчанию: `models`.

---

## 3. Режим тестирования (test)
Этот режим используется для анализа сетевого трафика в реальном времени с помощью уже обученной модели. Программа перехватывает трафик, вычисляет метрики и определяет, являются ли они аномальными.

### Синтаксис команды:
`python main.py test --interface <интерфейс> --network <сеть> --threshold <порог> [опции]`

### Ключевые параметры и их разъяснение:
1.  **`--interface <интерфейс>` (Обязательный)**:
    * **Разъяснение**: Указывает, какой сетевой интерфейс будет "прослушиваться". Например, `eth0` для Ethernet или `Wi-Fi` для беспроводной сети. Модуль `sniffer.py` использует **Scapy** для захвата пакетов только с этого интерфейса.

2.  **`--network <сеть>` (Обязательный)**:
    * **Разъяснение**: Задаёт диапазон IP-адресов в формате **CIDR** (например, `192.168.1.0/24`), трафик для которых будет анализироваться. Это позволяет фильтровать пакеты и обрабатывать только те, которые относятся к вашей локальной сети.

3.  **`--threshold <порог>` (Обязательный)**:
    * **Разъяснение**: Это числовое значение ошибки реконструкции, которое служит **порогом для определения аномалий**. Если ошибка, вычисленная нейронной сетью, превышает это значение, данные классифицируются как аномалия.

### Опции:
* `--time-step <число>`: Размер "окна" или последовательности, которую нейронная сеть использует для анализа. Должен быть таким же, как при обучении. По умолчанию: 10.
* `--interval <секунды>`: Интервал агрегации метрик. Программа собирает данные в течение этого времени, а затем анализирует их. По умолчанию: 10.
* `--model-dir <папка>`: Директория, из которой будет загружена ранее сохраненная модель. По умолчанию: `models`.

Быстрые команды для работы:
1)Сбор трафика с интерфейса с указанием сети и указанием интервала захвата
python main.py collect --interface "Realtek RTL8822CE 802.11ac PCIe Adapter" --network 192.168.1.0/24 --interval 4 --data-file normal_traffic_train.csv
2)Обучение модели и ее дальнейшее сохранение(указывается файл для обучения)
python main.py train --data-file normal_traffic.csv
3)Для обнаружения аномалий в статичном файле применяется режим validate
python main.py validate --data-file my_attack.csv
4)Для режима тестирования
python main.py test --interface "Realtek RTL8822CE 802.11ac PCIe Adapter" --network 192.168.1.0/24